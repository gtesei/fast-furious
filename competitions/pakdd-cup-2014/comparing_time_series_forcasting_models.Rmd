[R] Comparing time series forecasting models in action  
========================================================
Introduction
--------------------------------------------------------
Time series are analysed to understand the past and to predict the future, enabling managers or policy makers to make properly informed decisions.
In this post, a subset of typical time series forecasting models are compared in datasets split up in train set (70%) and cross validation set (30%). Performances on cross validation sets are compared in terms of 
* __MAE__ (Mean Average Error)
* __RSS__ (Residual Sum Squares)
* __MSE__ (Mean Squared Error)
* __RMSE__ (Root Mean Squared Error) 

Data sets
--------------------------------------------------------
Models are compared on the following data sets. 

### Sales of Australian wine
The data in the file wine.dat are monthly sales of Australian wine by category,
in thousands of litres, from January 1980 until July 1995. The categories are
fortified white, dry white, sweet white, red, rose, and sparkling. The sweet
white wine time series is plotted in Figure 3.9, and there is a dramatic increase
in sales in the second half of the 1980s followed by a reduction to a level well

```{r,warning=F} 
hurl <- new.env(hash=T, parent=emptyenv())
hurl[["maine.dat"]] = "http://elena.aut.ac.nz/~pcowpert/ts/Maine.dat"
hurl[["wine.dat"]] = "http://elena.aut.ac.nz/~pcowpert/ts/wine.dat"
hurl[["motororg.dat"]] = "http://elena.aut.ac.nz/~pcowpert/ts/motororg.dat"
hurl[["cbe.dat"]] = "http://elena.aut.ac.nz/~pcowpert/ts/cbe.dat"

www = hurl[['wine.dat']]
wine.dat = read.table(www,header=T)
attach(wine.dat)
sweetw.ts = ts(sweetw , start = c(1980,1) , freq = 12)
detach(wine.dat)
plot(sweetw.ts, xlab= "Time (months)", ylab = "sales (1000 litres)")
```

It follows a decomposition of trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(sweetw.ts))
```

### Air Passengers
The number of international passenger bookings (in thousands) per month
on an airline (Pan Am) in the United States were obtained from the Federal
Aviation Administration for the period 1949-1960 (Brown, 1963). The company
used the data to predict future demand before ordering new aircraft and
training aircrew. 

```{r,warning=F} 
data(AirPassengers)
AP <- AirPassengers
plot(AP, ylab = "Passengers (1000's)")
```

It follows a decomposition of trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(AP))
```

### Unemployment: Maine
Unemployment rates are one of the main economic indicators used by politicians
and other decision makers. For example, they influence policies for regional
development and welfare provision. Here we I consider the monthly unemployment rate
for the US state of Maine from January 1996 until August 2006.

**Unemployment: Maine**
```{r,warning=F} 
www = hurl[['maine.dat']]
Maine.month = read.table(www,header=T)
attach(Maine.month)
Maine.month.ts <- ts(unemploy, start = c(1996, 1), freq = 12)
detach(Maine.month)
Maine.annual.ts <- aggregate(Maine.month.ts)/12
par(mfrow=c(2,1))
plot(Maine.month.ts, ylab = "unemployed (%)" , xlab="Time (months)")
plot(Maine.annual.ts, ylab = "unemployed (%)" , xlab="Time (years)")
```

It follows a decomposition of trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(Maine.month.ts))
```

### Supply of Australian Chocolate, Electricity and Beer
The monthly supply of electricity (millions of kWh), beer (Ml),
and chocolate-based production (tonnes) in Australia over the period January
1958 to December 1990 from the Australian Bureau of Statistics
(ABS).

```{r,warning=F} 
www = hurl[['cbe.dat']]
CBE <- read.table(www, header = T)
attach(CBE)
Choc.ts <- ts(choc, start = c(1958, 1), freq = 12)
Elec.ts <- ts(elec, start = c(1958, 1), freq = 12)
Beer.ts <- ts(beer, start = c(1958, 1), freq = 12)
detach(CBE)
plot(cbind(Elec.ts, Beer.ts, Choc.ts) , xlab="Time (months)" , main="Choc (tonnes), Elec(kwh), Beer (Ml)"  )
```

It follows a decomposition of **chocolate supply** in trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(Choc.ts))
```


It follows a decomposition of **electricity supply** in trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(Elec.ts))
```


It follows a decomposition of **beer supply** in trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(Beer.ts))
```

### Complaints to a motoring organisation
The number of letters of complaint received each month by a motoring organisation
over the four years 1996 to 1999 are available on the website. At the
beginning of the year 2000, the organisation wishes to estimate the current
level of complaints and investigate any trend in the level of complaints.

```{r,warning=F} 
www = hurl[['motororg.dat']]
Motor.dat = read.table(www,header=T)
attach(Motor.dat)
Comp.ts <- ts(complaints, start = c(1996, 1), freq = 12)
detach(Motor.dat)
plot(Comp.ts, xlab = "Time / months", ylab = "Complaints")
```

It follows a decomposition of trend and seasonal effects using
a moving average method.

```{r,warning=F} 
plot(decompose(Comp.ts))
```



Forecasting models 
--------------------------------------------------------

### Autoregressive models
The series $\{{x_{t}}\}$ is an autoregressive process of order p, abbreviated to AR(p), if


${x_{t}}$ = ${x_{t-1}}$ ${a_{t-1}}$ + ${x_{t-2}}$ ${a_{t-2}}$ + ... + ${x_{t-p}}$ ${a_{t-p}}$ + ${w_{t}}$


where ${w_{t}}$ is white noise. Further details in [3]. 


### Holt-Winters models

The Holt-Winters method was suggested by Holt (1957) and Winters (1960), who
were working in the School of Industrial Administration at Carnegie Institute
of Technology, and uses exponentially weighted moving averages to update
estimates of the seasonally adjusted mean (called the level ), slope, and seasonals. Further details in [3].
Here are considered HW models with both additive and multiplicative seasonal components.

### Linear regression models 

### Linear regression models with seasonal variables

### Harmonic seasonal models

### SARIMA models

### Log-transformed SARIMA models








References
--------------------------------------------------------
1. J. Friedman, T. Hastie, R. Tibshirani, *The Elements of Statistical Learning*, Springer, 2009 
2. G. James, D. Witten, T. Hastie, R. Tibshirani, *The Elements of Statistical Learning*, Springer, 2013 
3. Paul S.P. Cowpertwait, Andrew V. Metcalfe, *Introductory Time Series with R*, Springer, 2009 



